<!-- blog/templates/blog/post_list.html -->
<!DOCTYPE html>
<html>
<head>
    <title>–ë–ª–æ–≥</title>
</head>
<body>
    <form method="get" action="{% url 'post_list' %}">
        <input type="text" name="q" value="{{ query }}" placeholder="–ü–æ–∏—Å–∫–∞...">

        {% if selected_tag %}
            <input type="hidden" name="tag" value="{{ selected_tag }}">
        {% endif %}
        <button type="submit">üîç –ù–∞–π—Ç–∏</button>
    </form>

    <h1>–í—Å–µ –ø–æ—Å—Ç—ã</h1>

    <div>
        <h3>–§–∏–ª—å—Ç—Ä –ø–æ —Ç–µ–≥–∞–º:</h3>
        <a href="{% url 'post_list' %}">–í—Å–µ</a>
        {% for tag in tags %}
            {% if tag.slug == selected_tag %}
                <strong>#{{ tag.name }}</strong>
            {% else %}
                <a href="?tag={{ tag.slug }}">#{{ tag.name }}</a>
            {% endif %}
        {% endfor %}
    </div>

    <hr>

{% for post in page_obj %}
    <div>
        <h2><a href="{% url 'post_detail' pk=post.pk %}">{{ post.title }}</a></h2>
        <p><strong>–ê–≤—Ç–æ—Ä:</strong> {{ post.author.username }}</p>
        <p>{{ post.content|truncatewords:20 }}</p>
        <p>üëÅ {{ post.views }} | ‚ù§Ô∏è {{ post.total_likes }}</p>
        <p>–¢–µ–≥–∏:
            {% for tag in post.tags.all %}
                <a href="?tag={{ tag.slug }}">{{ tag.name }}</a>
            {% endfor %}
        </p>
    </div>
    <hr>
{% empty %}
    <p>–ü–æ—Å—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.</p>
{% endfor %}

<!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
<div>
    <span>
        {% if page_obj.has_previous %}
            <a href="?{% if selected_tag %}tag={{ selected_tag }}&{% endif %}page={{ page_obj.previous_page_number }}">‚Üê –ù–∞–∑–∞–¥</a>
        {% endif %}

        –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page_obj.number }} –∏–∑ {{ page_obj.paginator.num_pages }}

        {% if page_obj.has_next %}
            <a href="?{% if selected_tag %}tag={{ selected_tag }}&{% endif %}page={{ page_obj.next_page_number }}">–í–ø–µ—Ä—ë–¥ ‚Üí</a>
        {% endif %}
    </span>
</div>
</body>
</html>
